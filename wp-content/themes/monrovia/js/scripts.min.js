jQuery(function(){if(!Modernizr.svg){var imgs=document.getElementsByTagName('img');var dotSVG=/.*\.svg$/;for(var i=0;i!=imgs.length;++i){if(imgs[i].src.match(dotSVG)){imgs[i].src=imgs[i].src.slice(0,-3)+"png";}}}});jQuery(document).ready(function($){getScreenWidth();jQuery('.mobile .prevent > a').on('click',function(e){if(jQuery('body').hasClass('mobile')){var a=jQuery(this);e.preventDefault();e.stopPropagation();if(a.parent('li').hasClass('menu-back')){a.parents('ul.sub-menu').removeClass('expanded')}else{a.parent('li').find('ul.sub-menu').addClass('expanded');}}});jQuery('.accordian > li > a').on('click',function(e){e.preventDefault();jQuery(this).toggleClass('open').parents('li').find('.accordianTarget').slideToggle(500);});jQuery('#newsletter-signup').on('click',function(e){e.preventDefault();var email=jQuery('#nemail').val();if(checkField(jQuery('#nemail'))!=1){jQuery('.newsletter.ajax-loader').show();jQuery('.newsletter-msg').html('').hide();var zip=getCookie('zip_code');var coldzone=getCookie('cold_zone');subscribeNewsletter(email,zip,coldzone);}else{jQuery('.newsletter-msg').addClass('error').html('Sorry, there was an error. Please try again.').show();setTimeout(function(){jQuery('.newsletter-msg').fadeOut(600);},2000);}});$('.question').on('click',function(){$(this).siblings('.tool-tip').show(400,'swing');});$('.tip-close').on('click',function(){$(this).parents('.tool-tip').hide(400,'swing');});$('input[type="checkbox"]').wrap('<div class="checkwrap"></div>').after('<span />');$('.wpcf7-form input, .wpcf7-form textarea, .widget input, .search input, input#nemail, input.hideLabel').not(':hidden').each(function(){var label=$(this).parent('div').find('label').html();if($(this).val()!=''){$(this).parents('.form-item').find('label').animate({'opacity':0.0},300);}
$(this).focus(function(){$(this).parents('.form-item').find('label').animate({'opacity':0.0},300);});$(this).blur(function(){if($(this).val()==""){$(this).parents('.form-item').find('label').show();$(this).parents('.form-item').find('label').animate({'opacity':1.0},300);}
else{$(this).parents('.form-item').find('label').hide();}});$(this).keypress(function(){$(this).parents('.form-item').find('label').hide();});});jQuery(window).resize(function(){getScreenWidth();});});jQuery(document).ready(function($){if(getCookie('zip_code')&&getCookie('cold_zone')){var cold=getCookie('cold_zone');cold=cold.replace('a','');cold=cold.replace('b','');jQuery('.zone-box span').html(cold);jQuery('.zipcode span').html(getCookie('zip_code'));}else{if(GetUrlValue('updated')!='true'){useMaximind();}}
jQuery('.zip-update').on('click',function(){$(this).siblings('.ajax-loader').show();var zip;jQuery('.zip-input').each(function(){if($(this).val()!=''){zip=$(this).val();}});getZone(zip);});$('.favorite-icon').on('click',function(){var user=$(this).attr('data-user');if(user=='true'){$(this).parents('.image-wrap').find('.ajax-loader').show();var process=$(this).attr('data-action');var plantID=$(this).attr('data-pid');var plantItem=$(this).attr('data-item');var that=$(this);$.post(ajaxurl,{action:'updateFavorites',ax:process,pid:plantID,itemNum:plantItem},function(data){data=jQuery.parseJSON(data);var result=data.result;if(data.result=='Added'){that.attr('data-action','remove').addClass('added').siblings('.favorite-text').html('Remove from Favorites');}else{that.attr('data-action','add').removeClass('added').siblings('.favorite-text').html('Add to Favorites');}
that.parents('.image-wrap').find('.ajax-loader').hide();});}else{alert("You must be logged in to add Favorites");}});jQuery('.checkKeypress').on('keypress',function(){checkField(jQuery(this));});jQuery('.checkBlur').on('blur',function(){checkField(jQuery(this));});});function getZone(postalCode){jQuery.post(ajaxurl,{action:'get_cold_zone',zipcode:postalCode},function(data){data=jQuery.parseJSON(data);var zipcode=data.zipcode;var zone=data.cold_zone;jQuery('.zone-box span').html(zone);jQuery('.zipcode span').html(zipcode);setCookie('zip_code',zipcode,365);setCookie('cold_zone',zone,365);jQuery('.widget .ajax-loader').hide();});}
function useMaximind(){var onSuccess=function(location){var string=JSON.stringify(location,undefined,4);var data=JSON.parse(string);var postalCode=data.postal.code;var city=data.city.names.en;getZone(postalCode);}
var onError=function(error){}
geoip2.city(onSuccess,onError);}
function subscribeNewsletter(email,zip,coldzone){jQuery.post(ajaxurl,{action:'addSubscription',zipcode:zip,newsletter:'true',email:email,coldzone:coldzone},function(data){data=jQuery.parseJSON(data);var msg;var display=jQuery('#signupMessage');if(data.result=='error'){msg='<strong>ERROR:</strong> You cannot be added at this time. Please try again later.';display.addClass('error');}else{msg='<strong>SUCCESS:</strong> You have been successfully signed up!';display.removeClass('error');}
jQuery('.newsletter.ajax-loader').hide();display.html(msg).show();});}
function setCookie(c_name,value,exdays)
{var exdate=new Date();exdate.setDate(exdate.getDate()+exdays);var c_value=escape(value)+((exdays==null)?"":"; expires="+exdate.toUTCString());var domain=location.host;domain=domain.replace(/^www\./,"");document.cookie=c_name+"="+c_value+"; path=/; domain=."+domain;}
function getCookie(c_name)
{var i,x,y,ARRcookies=document.cookie.split(";");for(i=0;i<ARRcookies.length;i++)
{x=ARRcookies[i].substr(0,ARRcookies[i].indexOf("="));y=ARRcookies[i].substr(ARRcookies[i].indexOf("=")+1);x=x.replace(/^\s+|\s+$/g,"");if(x==c_name)
{return unescape(y);}}}
function eraseCookie(name){setCookie(name,"",-1);}
function GetUrlValue(VarSearch){var SearchString=window.location.search.substring(1);var VariableArray=SearchString.split('&');for(var i=0;i<VariableArray.length;i++){var KeyValuePair=VariableArray[i].split('=');if(KeyValuePair[0]==VarSearch){return KeyValuePair[1];}}}
function checkField(el){var error=0;var emailcheck=/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;var value=el.val();console.log(value);var req=el.attr('data-req');var type=jQuery('input[name="type"]').val();if(value.length<1){error=1;}
if(el.is('#email')){if(!emailcheck.test(value)){error=1;}}
if(req='multi'){jQuery('.form-item.'+type).each(function(){if(jQuery(this).find('input').val().length<1){}else{}});}
if(error==1){el.parent('.form-item').removeClass('success').addClass('error');}else{el.parent('.form-item').removeClass('error').addClass('success');}
return error;}
function checkForm(form){jQuery('input[data-req="true"]').each(function(){checkField(jQuery(this));});var errors=form.find('.form-item.error');if(errors.length>0){jQuery('html, body').animate({scrollTop:0},800);jQuery('.global-message').addClass('error').html('Please correct the errors below.').show();return false;}else{jQuery('.global-message').removeClass('error').html('').hide();return true;}}
function loadPlantCollection(coldZone,zipCode,query,column,number,callback){jQuery.post(ajaxurl,{action:'getPlantCollection',coldzone:coldZone,zip:zipCode,query:query,column:column,number:number},function(data){data=jQuery.parseJSON(data);var zipcode=data.zipcode;var zone=data.cold_zone;var city=data.city;var state=data.state;var html=data.html;jQuery('.zone-box span').html(zone);jQuery('.zipcode span').html(zipcode);jQuery('#location').html(city+', '+state+' '+zipcode);jQuery('#query-results').html(html);callback();setCookie('zip_code',zipcode,365);setCookie('cold_zone',zone,365);setCookie('city',city,365);setCookie('state',state,365);});}
function getScreenWidth(){var width=jQuery('body').width();if(width<979){jQuery('body').addClass('mobile');}else{jQuery('body').removeClass('mobile');}}